(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-caea8b0e"],{"0e1a":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("wl-container",[a("div",[a("div",[a("sui-dimmer",{attrs:{active:e.loading,inverted:""}},[a("sui-loader",{attrs:{content:"Loading..."}})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:1!=e.role,expression:"role!=1"}],staticClass:"filterBiaoDan"},[a("sui-button",{attrs:{content:"申请维修",icon:"add green"},nativeOn:{click:function(t){return e.openWeiXiuForm(t)}}})],1),a("div",{staticClass:"vue2Table"},[a("vuetable",{key:e.componentKey,ref:"vuetable",attrs:{"api-mode":!1,data:e.localData,fields:e.fields,"sort-order":e.sortOrder,"data-path":"data","pagination-path":""},on:{"vuetable:pagination-data":e.onPaginationData},scopedSlots:e._u([{key:"statusText",fn:function(t){return a("div",{},[a("sui-header",{tag:"h4",attrs:{color:2==t.rowData.status?"green":"red"}},[e._v(" "+e._s(t.rowData.statusText)+" ")])],1)}},{key:"action",fn:function(t){return a("div",{},[a("sui-button",{attrs:{text:"编辑"},on:{click:function(a){return e.editWeixiuShenqing(t.rowData)}}},[e._v("编辑")]),a("sui-button",{attrs:{text:"删除"},on:{change:function(a){return e.handleChange(t)}}},[e._v("删除")])],1)}}])}),a("div",{staticClass:"pagination ui basic segment grid"},[a("vuetable-pagination-info",{ref:"paginationInfo"}),a("vuetable-pagination",{ref:"pagination",on:{"vuetable-pagination:change-page":e.onChangePage}})],1)],1),a("dialog-bar",{attrs:{commentData:e.deleteTarget.reason,type:"danger",title:"确认",content:e.deleteTarget.text,dangerText:e.deleteTarget.dangerText},on:{cancel:function(t){return e.clickCancel()},danger:function(t){return e.clickConfirmDelete()},confirm:function(t){return e.clickConfirmDelete()}},model:{value:e.sendVal,callback:function(t){e.sendVal=t},expression:"sendVal"}}),a("div",[a("sui-modal",{staticClass:"modal2",model:{value:e.weixiuForm.open,callback:function(t){e.$set(e.weixiuForm,"open",t)},expression:"weixiuForm.open"}},[a("sui-modal-header",[e._v(e._s(e.modelTitle)+"维修 "),a("sui-header",{tag:"h4",attrs:{color:2==e.selectedWeixiu.status?"green":"red"}},[e._v(" "+e._s(e.selectedWeixiu.statusText)+" ")])],1),a("sui-modal-content",{attrs:{scrolling:""}},[a("weixiu-form",{ref:"weixiuForm",attrs:{singleEntry:e.selectedWeixiu}})],1),a("sui-modal-actions",[a("sui-button",{attrs:{negative:""},nativeOn:{click:function(t){return e.closeWeiXiuForm(t)}}},[e._v(" 取消 ")]),a("sui-button",{attrs:{positive:""},nativeOn:{click:function(t){return e.createShenbao(t)}}},[e._v(" 保存 ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:1==e.role&&"edit"==e.modalMode,expression:"role==1&&modalMode=='edit'"}]},[a("sui-button",{attrs:{color:"green"},on:{click:function(t){return e.approveContract(e.selectedWeixiu)}}},[e._v("同意")]),a("sui-button",{attrs:{negative:""},on:{click:function(t){return e.rejectContract(e.selectedWeixiu)}}},[e._v("拒绝")])],1)],1)],1)],1)],1)])},n=[],o=(a("d81d"),a("b0c0"),a("5f53")),r=a("c3d0"),s=a("3568"),l=a("127e"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isHeader?a("th",{staticClass:"vuetable-th-component-switch",domProps:{innerHTML:e._s(e.title)}}):a("td",{staticClass:"vuetable-td-component-switch"},[a("div",{staticClass:"ui toggle checkbox"},[a("input",{attrs:{type:"checkbox"},domProps:{checked:e.checkValue(e.rowData,e.rowField)},on:{change:function(t){return e.toggleSwitch(e.rowData,t)}}}),e.rowField.switch.label?a("label",[e._v(e._s(e.label(e.rowData,e.rowField)))]):e._e()])])},d=[],u=a("1157"),f=a.n(u),g=a("da61"),p={name:"vuetable-field-switch",mixins:[g["a"]],methods:{toggleSwitch:function(e,t){console.log(f.a),console.log("toggleSwitch: ",t.target.checked)},label:function(e,t){return"function"===typeof t.switch.label?t.switch.label(e):t.switch.label},checkValue:function(e,t){return"function"===typeof t.switch.field?t.switch.field(e):e[t.switch.field]}}},h=p,m=a("2877"),b=Object(m["a"])(h,c,d,!1,null,null,null),E=(b.exports,[{name:"roomname",title:"房屋名称",width:"15%"},{name:"address",title:"房屋地址",width:"20%"},{name:"appdate",title:"申报时间",width:"15%"},{name:"unit_detail.name",title:"单位",width:"15%"},{name:"contract",title:"单位联系人",width:"15%"},{name:"tel",title:"电话",width:"15%"},{name:"statusText",title:"状态",width:"15%"},{name:"action",title:"操作",titleClass:"center aligned",dataClass:"center aligned",width:"30%"}]),v=a("1503"),x=[{name:"select",title:"",width:"10%"},{name:"roomname",title:"房屋名称",width:"15%"},{name:"address",title:"房屋地址",width:"20%"},{name:"building",title:"楼",width:"15%"},{name:"floor",title:"楼层",width:"15%"},{name:"apppdate",title:"申报时间",width:"15%"},{name:"statusText",title:"状态",width:"15%"}],w=[{name:"id",title:"合同号",width:"15%"},{name:"rep_unit",title:"维修单位",width:"20%"},{name:"created_on",title:"创建时间",width:"15%"},{name:"statusText",title:"状态",width:"15%"},{name:"action",title:"",width:"15%"}],y=a("1ec2"),_=a("fa33"),T=a("ee9b"),C=a("2b61"),k=(a("0b2f"),a("8e17")),O=a("ef4b"),j=a("0094"),A={name:"MyVuetable",components:{Datepicker:_["a"],"dialog-bar":o["a"],Vuetable:r["a"],VuetablePagination:s["a"],VuetablePaginationInfo:l["a"],"weixiu-form":y["a"]},data:function(){return{lang:T,hetongdata:[],hetongComponentKey:1,componentKey:1,currentStep:1,sendVal:!1,modelTitle:"",modalMode:"create",open:!1,filterString:{},weixiuList:[],value:[],role:2,weixiuForm:{open:!1},selectedWeixiu:{},deleteTarget:{},loading:!0,localData:[],fields:E,fields2:x,hetongFields:w,sortOrder:[{}],steps:[],weixiuhetong:{},contractForm:{open:!1,title:"createForm",room_id:"",amt:0,owner:"",rentunit:"",starttime:"",endtime:""}}},methods:{clickConfirmDelete:function(){this.loading=!0;var e=this;"approve"==this.deleteTarget.mode?Object(O["a"])(this.deleteTarget).then((function(t){e.loading=!1,0==t.data.code?(e.closeComfirmDialog(),e.closeWeiXiuForm(),e.$notify({group:"foo",title:"已经同意",text:"已经同意",type:"success"})):Object(k["a"])(v["a"].CREATEFAILED,v["a"].CREATEFAILED,v["a"].typeError)})).catch((function(t){e.loading=!1,Object(k["a"])(v["a"].CREATEFAILED,v["a"].CREATEFAILED,v["a"].typeError)})):"reject"==this.deleteTarget.mode&&(this.loading=!1,Object(O["h"])(this.deleteTarget).then((function(t){0==t.data.code?(e.closeComfirmDialog(),e.$notify({group:"foo",title:"已经拒绝",text:"已经拒绝",type:"success"})):Object(k["a"])(v["a"].CREATEFAILED,v["a"].CREATEFAILED,v["a"].typeError)})).catch((function(t){e.loading=!1,Object(k["a"])(v["a"].CREATEFAILED,v["a"].CREATEFAILED,v["a"].typeError)})))},openComfirmDialog:function(){this.sendVal=!0},closeComfirmDialog:function(){this.sendVal=!1,this.refreshWeixiuList()},approveContract:function(e){this.sendVal=!0,this.deleteTarget.text="是否要同意该申请"+e.roomname+"(申请id:"+e.id+")?",this.deleteTarget.mode="approve",this.deleteTarget.dangerText="确认",this.deleteTarget.reason="无",this.deleteTarget.id=e.id,this.openComfirmDialog()},rejectContract:function(e){this.sendVal=!0,this.deleteTarget.text="是否要拒绝该申请"+e.roomname+"(申请id:"+e.id+")?",this.deleteTarget.mode="reject",this.deleteTarget.id=e.id,this.deleteTarget.reason="无",this.deleteTarget.dangerText="确认",this.openComfirmDialog()},editWeixiuShenqing:function(e){var t=this;if(this.selectedWeixiu=e,this.modelTitle="编辑",this.loading=!0,this.selectedWeixiu.room_id&&this.selectedWeixiu.building_id){var a=[],i=[],n=this;Object(j["t"])(n.selectedWeixiu).then((function(e){e.data.data.map((function(e){i.push({text:e.name,value:e.id})})),n.$refs.weixiuForm.louOptions=i,Object(j["s"])(n.selectedWeixiu).then((function(e){var i=e.data.data;i.map((function(e){a.push({text:e.name,value:e.id})})),n.$refs.weixiuForm.floorOptions=a,t.loading=!1,n.openWeiXiuForm("edit")}))}))}else context.openWeiXiuForm("edit")},createWeiXiuHeTong:function(){var e=this;console.log(this.weixiuhetong),this.weixiuhetong.mrlist=[],this.weixiuList.map((function(t){e.weixiuhetong.mrlist.push(t.id)})),this.weixiuhetong.memo="test",this.loading=!0;closeHetongModal(),Object(O["b"])(this.weixiuhetong).then((function(t){e.loading=!1,0==t.data.code?Object(k["a"])(v["a"].CREATESUCCESS,v["a"].CREATESUCCESS,v["a"].typeSuccess):Object(k["a"])(v["a"].CREATEFAILED,v["a"].CREATEFAILED,v["a"].typeError)})).catch((function(e){this.loading=!1,Object(k["a"])(v["a"].CREATEFAILED,v["a"].CREATEFAILED,v["a"].typeError)}))},closeHetongModal:function(){this.open=!1},createShenbao:function(){var e=this;this.loading=!0,"create"==this.modalMode?Object(O["c"])(this.selectedWeixiu).then((function(t){e.loading=!1,e.closeWeiXiuForm(),e.refreshWeixiuList(),Object(k["a"])(v["a"].CREATESUCCESS,v["a"].CREATESUCCESS,v["a"].typeSuccess)})):"edit"==this.modalMode&&Object(O["d"])(this.selectedWeixiu).then((function(t){console.log(t),e.loading=!1,e.closeWeiXiuForm(),e.refreshWeixiuList(),Object(k["a"])("编辑成功","编辑成功",v["a"].typeSuccess)}))},refreshWeixiuList:function(){var e=this;this.role=Object(C["b"])("role"),this.loading=!0;var t={};1==this.role&&(t={status:v["a"].STATUSNEW}),Object(O["f"])(t).then((function(t){e.loading=!1,e.localData={total:16,per_page:5,current_page:1,last_page:4,next_page_url:"data.data.data?page=2",prev_page_url:null,from:1,to:5,data:t.data.data},e.localData.data.map((function(t){switch(Object(O["g"])(t).then((function(a){console.log(a),0==a.data.code&&(t.roomname=a.data.data.roomname,t.address=a.data.data.address,console.log(t.address),console.log(e.localData.data),e.componentKey++)})),t.status){case 1:t.statusText=v["a"].NEW;break;case 2:t.statusText=v["a"].PASS;break;case 3:t.statusText=v["a"].FAIL;break;default:break}}))}))},openWeiXiuForm:function(e){"edit"==e?(this.modelTitle="编辑",this.modalMode="edit"):(this.modelTitle="创建",this.selectedWeixiu={},this.modalMode="create"),this.weixiuForm.open=!0},closeWeiXiuForm:function(){this.weixiuForm.open=!1},onPaginationData:function(e){this.$refs.pagination.setPaginationData(e),this.$refs.paginationInfo.setPaginationData(e)},onChangePage:function(e){this.$refs.vuetable.changePage(e)}},mounted:function(){var e=this;this.role=Object(C["b"])("role"),this.loading=!0;var t={};1==this.role&&(t={status:v["a"].STATUSNEW}),Object(O["f"])(t).then((function(t){e.loading=!1,e.localData={total:16,per_page:5,current_page:1,last_page:4,next_page_url:"data.data.data?page=2",prev_page_url:null,from:1,to:5,data:t.data.data},e.localData.data.map((function(t){switch(Object(O["g"])(t).then((function(a){console.log(a),0==a.data.code&&(t.roomname=a.data.data.roomname,t.address=a.data.data.address,console.log(t.address),console.log(e.localData.data),e.componentKey++)})),t.status){case 1:t.statusText=v["a"].NEW;break;case 2:t.statusText=v["a"].PASS;break;case 3:t.statusText=v["a"].FAIL;break;default:break}}))}))}},D=A,F=(a("f4e5"),Object(m["a"])(D,i,n,!1,null,null,null));t["default"]=F.exports},1503:function(e,t,a){"use strict";var i={typeSuccess:"success",typeError:"error",NEW:"新建",PASS:"审核通过",FAIL:"审核失败",CREATESUCCESS:"创建成功",DELETESUCCESS:"删除成功",DELETEFAILED:"删除失败",CREATEFAILED:"创建失败",FENPEISUCCESS:"创建成功",FENPEIFAILED:"创建失败",STATUSNEW:1,typeRoomAssignment:2,typeRentRoom:2,typeRoom:1};t["a"]=i},"1ec2":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("sui-form",{staticClass:"marginBottom30"},[a("sui-form-fields",[a("sui-form-field",[a("label",[e._v("申报单号")]),a("sui-input",{attrs:{placeholder:"申报单号"},model:{value:e.singleEntry.appid,callback:function(t){e.$set(e.singleEntry,"appid",t)},expression:"singleEntry.appid"}})],1),a("sui-form-field",[a("label",[e._v("申报日期")]),a("datepicker",{attrs:{value:e.singleEntry.appdate,language:e.lang["zh"]},model:{value:e.singleEntry.appdate,callback:function(t){e.$set(e.singleEntry,"appdate",t)},expression:"singleEntry.appdate"}})],1)],1),a("sui-form-fields",[a("sui-form-field",[a("label",[e._v("联系人")]),a("sui-input",{attrs:{placeholder:"联系人"},model:{value:e.singleEntry.contract,callback:function(t){e.$set(e.singleEntry,"contract",t)},expression:"singleEntry.contract"}})],1),a("sui-form-field",[a("label",[e._v("联系电话")]),a("sui-input",{attrs:{placeholder:"联系电话"},model:{value:e.singleEntry.tel,callback:function(t){e.$set(e.singleEntry,"tel",t)},expression:"singleEntry.tel"}})],1)],1),a("sui-form-fields",[a("sui-form-field",[a("label",[e._v("维修理由")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.singleEntry.reason,expression:"singleEntry.reason"}],domProps:{value:e.singleEntry.reason},on:{input:function(t){t.target.composing||e.$set(e.singleEntry,"reason",t.target.value)}}})])],1),a("sui-form-fields",[a("sui-form-field",[a("label",[e._v("房屋")]),a("sui-dropdown",{attrs:{placeholder:"选择房屋",selection:"",options:e.options},on:{input:function(t){return e.setFang()}},model:{value:e.singleEntry.room_id,callback:function(t){e.$set(e.singleEntry,"room_id",t)},expression:"singleEntry.room_id"}})],1),a("sui-form-field",[a("label",[e._v("房")]),a("sui-dropdown",{attrs:{placeholder:"选择房",selection:"",options:e.louOptions,loading:e.louLoading,disabled:e.louLoading},on:{input:function(t){return e.setFloor()}},model:{value:e.singleEntry.building_id,callback:function(t){e.$set(e.singleEntry,"building_id",t)},expression:"singleEntry.building_id"}})],1),a("sui-form-field",[a("label",[e._v("楼")]),a("sui-dropdown",{attrs:{floating:"",direction:"upward",placeholder:"选择楼",selection:"",options:e.floorOptions,loading:e.floorLoading,disabled:e.floorLoading},model:{value:e.singleEntry.floor_id,callback:function(t){e.$set(e.singleEntry,"floor_id",t)},expression:"singleEntry.floor_id"}})],1)],1)],1)],1)},n=[],o=(a("d81d"),a("b0c0"),a("fa33")),r=a("ee9b"),s=a("0094"),l={name:"weixiu-form",components:{Datepicker:o["a"]},props:["singleEntry"],data:function(){return{options:[],louOptions:[],floorOptions:[],floorLoading:!1,louLoading:!1,lang:r,disabled:!1}},methods:{setFloor:function(){var e=this;console.log(this.singleEntry.building_id),this.floorOptions=[],this.floorLoading=!0,null!=this.singleEntry.building_id&&Object(s["s"])(this.singleEntry).then((function(t){var a=t.data.data;a.map((function(t){e.floorOptions.push({text:t.name,value:t.id})})),e.floorLoading=!1})),this.louLoading=!1},setFang:function(){var e=this;console.log(this.singleEntry.room_id),this.louOptions=[],this.louLoading=!0,null!=this.singleEntry.room_id&&Object(s["t"])(this.singleEntry).then((function(t){t.data.data.map((function(t){e.louOptions.push({text:t.name,value:t.id})})),e.louLoading=!1}))}},mounted:function(){var e=this;Object(s["y"])().then((function(t){t.data.data.map((function(t){e.options.push({text:t.roomname,value:t.id})}))}))}},c=l,d=(a("2118"),a("2877")),u=Object(d["a"])(c,i,n,!1,null,null,null);t["a"]=u.exports},2118:function(e,t,a){"use strict";var i=a("95ff"),n=a.n(i);n.a},"72d7":function(e,t,a){},"8e17":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a("2b0e");function n(e,t,a){i["default"].notify({group:"foo",title:e,text:t,type:a})}},"95ff":function(e,t,a){},ef4b:function(e,t,a){"use strict";a.d(t,"f",(function(){return s})),a.d(t,"c",(function(){return c})),a.d(t,"d",(function(){return p})),a.d(t,"g",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"e",(function(){return l})),a.d(t,"i",(function(){return f})),a.d(t,"a",(function(){return g})),a.d(t,"h",(function(){return m}));var i=a("77e5"),n=a("dd5d"),o=a("1a43"),r=a("2b61");function s(e){var t=Object(r["b"])(o["a"].project_key,!0);console.log(e);var a={};return a=void 0==e.status?{token:t}:{token:t,status:e.status},Object(i["a"])({url:n["a"].getMRAPI,method:"post",data:a})}function l(){var e=Object(r["b"])(o["a"].project_key,!0),t={token:e};return Object(i["a"])({url:n["a"].getMCAPI,method:"post",data:t})}function c(e){var t=Object(r["b"])(o["a"].project_key,!0);return e.token=t,Object(i["a"])({url:n["a"].createMRAPI,method:"post",data:e})}function d(e){var t=Object(r["b"])(o["a"].project_key,!0);return e.token=t,Object(i["a"])({url:n["a"].getRoomByIDApi,method:"post",data:e})}function u(e){var t=Object(r["b"])(o["a"].project_key,!0);return e.token=t,Object(i["a"])({url:n["a"].createMCApi,method:"post",data:e})}function f(e){var t=Object(r["b"])(o["a"].project_key,!0);return e.token=t,Object(i["a"])({url:n["a"].updateMCApi,method:"post",data:e})}function g(e){return h(e,n["a"].approveMRApi)}function p(e){return h(e,n["a"].editMRAPI)}function h(e,t){var a=Object(r["b"])(o["a"].project_key,!0);return e.token=a,Object(i["a"])({url:t,method:"post",data:e})}function m(e){return h(e,n["a"].rejectMRApi)}},f4e5:function(e,t,a){"use strict";var i=a("72d7"),n=a.n(i);n.a}}]);
//# sourceMappingURL=chunk-caea8b0e.cb343cb4.js.map