(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b22a7ef"],{"05ca":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("wl-container",[a("div",[a("div",[a("sui-dimmer",{attrs:{active:t.loading,inverted:""}},[a("sui-loader",{attrs:{content:"Loading..."}})],1)],1),a("div",{staticClass:"filterBiaoDan"},[a("sui-button",{attrs:{content:"创建维修计划",icon:"add green"},nativeOn:{click:function(e){return t.openWeiXiuJihua(e)}}})],1),a("div",{staticClass:"vue2Table"},[a("vuetable",{key:t.hetongComponentKey,ref:"vuetable",attrs:{"api-mode":!1,data:t.hetongdata,fields:t.hetongFields,"sort-order":t.sortOrder,"data-path":"data","pagination-path":""},on:{"vuetable:pagination-data":t.onPaginationData},scopedSlots:t._u([{key:"action",fn:function(e){return a("div",{},[a("sui-button",{on:{click:function(a){return t.editHeTongData(e.rowData)}}},[t._v("编辑")]),a("sui-button",[t._v("删除")])],1)}}])}),a("div",{staticClass:"pagination ui basic segment grid"},[a("vuetable-pagination-info",{ref:"paginationInfo"}),a("vuetable-pagination",{ref:"pagination",on:{"vuetable-pagination:change-page":t.onChangePage}})],1)],1),a("dialog-bar",{attrs:{commentData:t.deleteTarget.comment,type:"danger",title:"是否要删除",content:t.deleteTarget.text,dangerText:"确认删除"},on:{cancel:function(e){return t.clickCancel()},danger:function(e){return t.clickConfirmDelete()},confirm:function(e){return t.clickConfirmDelete()}},model:{value:t.sendVal,callback:function(e){t.sendVal=e},expression:"sendVal"}}),a("div",[a("sui-modal",{staticClass:"modal2",model:{value:t.open,callback:function(e){t.open=e},expression:"open"}},[a("sui-modal-content",{attrs:{scrolling:""}},[a("div",[a("sui-step-group",[a("sui-step",{attrs:{active:1==t.currentStep}},[a("sui-icon",{attrs:{name:"truck"}}),a("sui-step-content",[a("sui-step-title",[t._v("选择维修房屋")])],1)],1),a("sui-step",{attrs:{active:2==t.currentStep}},[a("sui-icon",{attrs:{name:"payment"}}),a("sui-step-content",{attrs:{title:"填写合同信息"}})],1),a("sui-step",{attrs:{active:3==t.currentStep}},[a("sui-icon",{attrs:{name:"info"}}),a("sui-step-content",{attrs:{title:"上传合同"}})],1)],1),a("sui-step-group",{attrs:{steps:t.steps}})],1),a("sui-segment",{directives:[{name:"show",rawName:"v-show",value:1==t.currentStep,expression:"currentStep==1"}]},[a("div",{staticClass:"vue2Table"},[a("vuetable",{key:t.componentKey,ref:"vuetable",attrs:{"api-mode":!1,data:t.localData,fields:t.fields2,"sort-order":t.sortOrder,"data-path":"data","pagination-path":""},on:{"vuetable:pagination-data":t.onPaginationData},scopedSlots:t._u([{key:"select",fn:function(e){return a("div",{},[a("sui-checkbox",{on:{change:function(a){return t.handleChange(e)}},model:{value:e.rowData.select,callback:function(a){t.$set(e.rowData,"select",a)},expression:"props.rowData.select"}})],1)}}])}),a("div",{staticClass:"pagination ui basic segment grid"},[a("vuetable-pagination-info",{ref:"paginationInfo"}),a("vuetable-pagination",{ref:"pagination",on:{"vuetable-pagination:change-page":t.onChangePage}})],1)],1)]),a("sui-segment",{directives:[{name:"show",rawName:"v-show",value:2==t.currentStep,expression:"currentStep==2"}]},[a("sui-form",[a("sui-form-fields",{attrs:{inline:""}},[a("label",[t._v("维修时间")]),a("sui-form-field",[a("datepicker",{attrs:{value:t.weixiuhetong.starttime,language:t.lang["zh"]},model:{value:t.weixiuhetong.starttime,callback:function(e){t.$set(t.weixiuhetong,"starttime",e)},expression:"weixiuhetong.starttime"}})],1),a("label",[t._v(" 到")]),a("sui-form-field",[a("datepicker",{attrs:{value:t.weixiuhetong.endtime,language:t.lang["zh"]},model:{value:t.weixiuhetong.endtime,callback:function(e){t.$set(t.weixiuhetong,"endtime",e)},expression:"weixiuhetong.endtime"}})],1),a("label",[t._v("合同状态")]),a("sui-form-field",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.weixiuhetong.status,expression:"weixiuhetong.status"}],attrs:{type:"text",placeholder:"请选择"},domProps:{value:t.weixiuhetong.status},on:{input:function(e){e.target.composing||t.$set(t.weixiuhetong,"status",e.target.value)}}})])],1),a("sui-form-fields",{attrs:{inline:""}},[a("label",[t._v("维修单位")]),a("sui-form-field",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.weixiuhetong.rep_unit,expression:"weixiuhetong.rep_unit"}],attrs:{type:"text",placeholder:"请选择"},domProps:{value:t.weixiuhetong.rep_unit},on:{input:function(e){e.target.composing||t.$set(t.weixiuhetong,"rep_unit",e.target.value)}}})]),a("label",[t._v(" 维修金额")]),a("sui-form-field",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.weixiuhetong.rep_contact,expression:"weixiuhetong.rep_contact"}],attrs:{type:"text",placeholder:"请选择"},domProps:{value:t.weixiuhetong.rep_contact},on:{input:function(e){e.target.composing||t.$set(t.weixiuhetong,"rep_contact",e.target.value)}}})])],1)],1)],1),a("sui-segment",{directives:[{name:"show",rawName:"v-show",value:3==t.currentStep,expression:"currentStep==3"}]},[a("sui-button",{attrs:{icon:"upload"}}),t._v("上传附件 ")],1)],1),a("sui-modal-actions",[a("sui-button",{attrs:{negative:""},nativeOn:{click:function(e){return t.closeModal(e)}}},[t._v(" 取消 ")]),1!==t.currentStep?a("sui-button",{attrs:{positive:""},nativeOn:{click:function(e){return t.goToPreviousStep(e)}}},[t._v(" 上一步 ")]):t._e(),3!==t.currentStep?a("sui-button",{attrs:{positive:""},nativeOn:{click:function(e){return t.goToNextStep(e)}}},[t._v(" 下一步 ")]):t._e(),3==t.currentStep?a("sui-button",{attrs:{positive:""},nativeOn:{click:function(e){return t.createWeiXiuHeTong(e)}}},[t._v(" 确定 ")]):t._e()],1)],1)],1)],1)])},i=[],o=(a("d81d"),a("a434"),a("5f53")),s=a("c3d0"),r=a("3568"),l=a("127e"),u=[{name:"id",title:"合同号",width:"15%"},{name:"rep_unit",title:"维修单位",width:"20%"},{name:"created_on",title:"创建时间",width:"15%"},{name:"statusText",title:"状态",width:"15%"},{name:"action",title:"",width:"15%"}],c=a("1ec2"),d=a("fa33"),p=a("ee9b"),g=(a("0b2f"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isHeader?a("th",{staticClass:"vuetable-th-component-switch",domProps:{innerHTML:t._s(t.title)}}):a("td",{staticClass:"vuetable-td-component-switch"},[a("div",{staticClass:"ui toggle checkbox"},[a("input",{attrs:{type:"checkbox"},domProps:{checked:t.checkValue(t.rowData,t.rowField)},on:{change:function(e){return t.toggleSwitch(t.rowData,e)}}}),t.rowField.switch.label?a("label",[t._v(t._s(t.label(t.rowData,t.rowField)))]):t._e()])])}),f=[],h=a("1157"),m=a.n(h),v=a("da61"),b={name:"vuetable-field-switch",mixins:[v["a"]],methods:{toggleSwitch:function(t,e){console.log(m.a),console.log("toggleSwitch: ",e.target.checked)},label:function(t,e){return"function"===typeof e.switch.label?e.switch.label(t):e.switch.label},checkValue:function(t,e){return"function"===typeof e.switch.field?e.switch.field(t):t[e.switch.field]}}},w=b,x=a("2877"),_=Object(x["a"])(w,g,f,!1,null,null,null),y=(_.exports,[{name:"select",title:"",width:"10%"},{name:"roomname",title:"房屋名称",width:"15%"},{name:"address",title:"房屋地址",width:"20%"},{name:"building",title:"楼",width:"15%"},{name:"floor",title:"楼层",width:"15%"},{name:"apppdate",title:"申报时间",width:"15%"},{name:"statusText",title:"状态",width:"15%"}]),k=a("ef4b"),O={name:"MyVuetable",components:{Datepicker:d["a"],"dialog-bar":o["a"],Vuetable:s["a"],VuetablePagination:r["a"],VuetablePaginationInfo:l["a"],"weixiu-form":c["a"]},data:function(){return{fields2:y,lang:p,hetongdata:[],hetongComponentKey:1,componentKey:1,currentStep:1,sendVal:!1,open:!1,weixiuList:[],value:[],mode:"",weixiuForm:{open:!1},selectedWeixiu:{},deleteTarget:"",loading:!0,localData:[],hetongFields:u,sortOrder:[{}],steps:[],weixiuhetong:{}}},methods:{editHeTongData:function(t){var e=this;this.resetStep(),this.mode="edit",this.weixiuhetong=t,this.weixiuList=[];var a=JSON.parse(this.weixiuhetong.mrlist);this.localData.data.map((function(t){t.select=!1,a.map((function(a){a==t.id&&(t.select=!0,e.weixiuList.push(t))}))})),this.componentKey++,this.open=!0},resetStep:function(){this.currentStep=1},createWeiXiuHeTong:function(){var t=this;this.resetStep(),this.weixiuhetong.mrlist=[],this.weixiuList.map((function(e){t.weixiuhetong.mrlist.push(e.id)})),this.weixiuhetong.mrlist=JSON.stringify(this.weixiuhetong.mrlist),this.loading=!0;var e=this;this.closeHetongModal(),"create"==this.mode?Object(k["b"])(this.weixiuhetong).then((function(t){e.loading=!1,0==t.data.code?(e.refreshHetongList(),e.$notify({group:"foo",title:"创建成功",text:"创建成功",type:"success"})):e.$notify({group:"foo",title:"创建失败",text:"创建失败",type:"error"})})).catch((function(t){this.loading=!1,e.$notify({group:"foo",title:"创建失败",text:"创建失败",type:"error"})})):"edit"==this.mode&&Object(k["i"])(this.weixiuhetong).then((function(t){e.loading=!1,0==t.data.code?(e.refreshHetongList(),e.$notify({group:"foo",title:"更新成功",text:"更新成功",type:"success"})):e.$notify({group:"foo",title:"更新失败",text:"更新失败",type:"error"})})).catch((function(t){this.loading=!1,e.$notify({group:"foo",title:"更新失败",text:"更新失败",type:"error"})}))},closeHetongModal:function(){this.open=!1},createShenbao:function(){var t=this;this.loading=!0,Object(k["c"])(this.selectedWeixiu).then((function(e){console.log(e),t.loading=!1,t.closeWeiXiuForm(),t.refreshWeixiuList()}))},refreshHetongList:function(){var t=this;this.loading=!0,Object(k["e"])().then((function(e){t.loading=!1,console.log(e.data.data),t.hetongdata={total:16,per_page:5,current_page:1,last_page:4,next_page_url:"data.data.data?page=2",prev_page_url:null,from:1,to:5,data:e.data.data},t.hetongdata.data.map((function(t){switch(t.status){case 1:t.statusText="未开始";break;case 2:t.statusText="开始维修";break;case 3:t.statusText="维修完成";break;default:break}}))}))},refreshWeixiuList:function(){var t=this;this.loading=!0,Object(k["f"])({status:2}).then((function(e){t.loading=!1,t.localData={total:16,per_page:5,current_page:1,last_page:4,next_page_url:"data.data.data?page=2",prev_page_url:null,from:1,to:5,data:e.data.data},t.localData.data.map((function(e){switch(Object(k["g"])(e).then((function(a){console.log(a),0==a.data.code&&(e.roomname=a.data.data.roomname,e.address=a.data.data.address,console.log(e.address),console.log(t.localData.data),t.componentKey++)})),e.status){case 1:e.statusText="新建";break;case 2:e.statusText="审核通过";break;case 3:e.statusText="审核失败";break;default:break}}))}))},openWeiXiuJihua:function(){this.mode="create",this.weixiuhetong={},this.resetStep(),this.localData.data.map((function(t){t.select=!1})),this.selectedlist=[],this.componentKey++,this.open=!0},goToPreviousStep:function(){this.currentStep--},goToNextStep:function(){this.currentStep++},handleChange:function(t){var e=this;console.log(this.weixiuList);var a=0;this.weixiuList.map((function(n,i){n.id!==t.rowData.id||(a++,e.weixiuList.splice(i,1))})),0!=a?console.log(this.weixiuList):this.weixiuList.push(t.rowData)},onPaginationData:function(t){this.$refs.pagination.setPaginationData(t),this.$refs.paginationInfo.setPaginationData(t)},onChangePage:function(t){this.$refs.vuetable.changePage(t)},closeModal:function(){this.open=!1}},mounted:function(){var t=this;this.loading=!0,Object(k["f"])({status:2}).then((function(e){t.loading=!1,t.localData={total:16,per_page:5,current_page:1,last_page:4,next_page_url:"data.data.data?page=2",prev_page_url:null,from:1,to:5,data:e.data.data},t.localData.data.map((function(e){switch(Object(k["g"])(e).then((function(a){console.log(a),0==a.data.code&&(e.roomname=a.data.data.roomname,e.address=a.data.data.address,console.log(e.address),console.log(t.localData.data),t.componentKey++)})),e.status){case 1:e.statusText="新建";break;case 2:e.statusText="审核通过";break;case 3:e.statusText="审核失败";break;default:break}}))})),Object(k["e"])().then((function(e){t.loading=!1,console.log(e.data.data),t.hetongdata={total:16,per_page:5,current_page:1,last_page:4,next_page_url:"data.data.data?page=2",prev_page_url:null,from:1,to:5,data:e.data.data},t.hetongdata.data.map((function(t){switch(t.status){case 1:t.statusText="未开始";break;case 2:t.statusText="开始维修";break;case 3:t.statusText="维修完成";break;default:break}}))}))}},j=O,E=(a("4362d"),Object(x["a"])(j,n,i,!1,null,null,null));e["default"]=E.exports},"1ec2":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("sui-form",{staticClass:"marginBottom30"},[a("sui-form-fields",[a("sui-form-field",[a("label",[t._v("申报单号")]),a("sui-input",{attrs:{placeholder:"申报单号"},model:{value:t.singleEntry.appid,callback:function(e){t.$set(t.singleEntry,"appid",e)},expression:"singleEntry.appid"}})],1),a("sui-form-field",[a("label",[t._v("申报日期")]),a("datepicker",{attrs:{value:t.singleEntry.appdate,language:t.lang["zh"]},model:{value:t.singleEntry.appdate,callback:function(e){t.$set(t.singleEntry,"appdate",e)},expression:"singleEntry.appdate"}})],1)],1),a("sui-form-fields",[a("sui-form-field",[a("label",[t._v("联系人")]),a("sui-input",{attrs:{placeholder:"联系人"},model:{value:t.singleEntry.contract,callback:function(e){t.$set(t.singleEntry,"contract",e)},expression:"singleEntry.contract"}})],1),a("sui-form-field",[a("label",[t._v("联系电话")]),a("sui-input",{attrs:{placeholder:"联系电话"},model:{value:t.singleEntry.tel,callback:function(e){t.$set(t.singleEntry,"tel",e)},expression:"singleEntry.tel"}})],1)],1),a("sui-form-fields",[a("sui-form-field",[a("label",[t._v("维修理由")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.singleEntry.reason,expression:"singleEntry.reason"}],domProps:{value:t.singleEntry.reason},on:{input:function(e){e.target.composing||t.$set(t.singleEntry,"reason",e.target.value)}}})])],1),a("sui-form-fields",[a("sui-form-field",[a("label",[t._v("房屋")]),a("sui-dropdown",{attrs:{placeholder:"选择房屋",selection:"",options:t.options},on:{input:function(e){return t.setFang()}},model:{value:t.singleEntry.room_id,callback:function(e){t.$set(t.singleEntry,"room_id",e)},expression:"singleEntry.room_id"}})],1),a("sui-form-field",[a("label",[t._v("房")]),a("sui-dropdown",{attrs:{placeholder:"选择房",selection:"",options:t.louOptions,loading:t.louLoading,disabled:t.louLoading},on:{input:function(e){return t.setFloor()}},model:{value:t.singleEntry.building_id,callback:function(e){t.$set(t.singleEntry,"building_id",e)},expression:"singleEntry.building_id"}})],1),a("sui-form-field",[a("label",[t._v("楼")]),a("sui-dropdown",{attrs:{floating:"",direction:"upward",placeholder:"选择楼",selection:"",options:t.floorOptions,loading:t.floorLoading,disabled:t.floorLoading},model:{value:t.singleEntry.floor_id,callback:function(e){t.$set(t.singleEntry,"floor_id",e)},expression:"singleEntry.floor_id"}})],1)],1)],1)],1)},i=[],o=(a("d81d"),a("b0c0"),a("fa33")),s=a("ee9b"),r=a("0094"),l={name:"weixiu-form",components:{Datepicker:o["a"]},props:["singleEntry"],data:function(){return{options:[],louOptions:[],floorOptions:[],floorLoading:!1,louLoading:!1,lang:s,disabled:!1}},methods:{setFloor:function(){var t=this;console.log(this.singleEntry.building_id),this.floorOptions=[],this.floorLoading=!0,null!=this.singleEntry.building_id&&Object(r["s"])(this.singleEntry).then((function(e){var a=e.data.data;a.map((function(e){t.floorOptions.push({text:e.name,value:e.id})})),t.floorLoading=!1})),this.louLoading=!1},setFang:function(){var t=this;console.log(this.singleEntry.room_id),this.louOptions=[],this.louLoading=!0,null!=this.singleEntry.room_id&&Object(r["t"])(this.singleEntry).then((function(e){e.data.data.map((function(e){t.louOptions.push({text:e.name,value:e.id})})),t.louLoading=!1}))}},mounted:function(){var t=this;Object(r["y"])().then((function(e){e.data.data.map((function(e){t.options.push({text:e.roomname,value:e.id})}))}))}},u=l,c=(a("2118"),a("2877")),d=Object(c["a"])(u,n,i,!1,null,null,null);e["a"]=d.exports},2118:function(t,e,a){"use strict";var n=a("95ff"),i=a.n(n);i.a},"4362d":function(t,e,a){"use strict";var n=a("5e1d"),i=a.n(n);i.a},"5e1d":function(t,e,a){},"95ff":function(t,e,a){},ef4b:function(t,e,a){"use strict";a.d(e,"f",(function(){return r})),a.d(e,"c",(function(){return u})),a.d(e,"d",(function(){return f})),a.d(e,"g",(function(){return c})),a.d(e,"b",(function(){return d})),a.d(e,"e",(function(){return l})),a.d(e,"i",(function(){return p})),a.d(e,"a",(function(){return g})),a.d(e,"h",(function(){return m}));var n=a("77e5"),i=a("dd5d"),o=a("1a43"),s=a("2b61");function r(t){var e=Object(s["b"])(o["a"].project_key,!0);console.log(t);var a={};return a=void 0==t.status?{token:e}:{token:e,status:t.status},Object(n["a"])({url:i["a"].getMRAPI,method:"post",data:a})}function l(){var t=Object(s["b"])(o["a"].project_key,!0),e={token:t};return Object(n["a"])({url:i["a"].getMCAPI,method:"post",data:e})}function u(t){var e=Object(s["b"])(o["a"].project_key,!0);return t.token=e,Object(n["a"])({url:i["a"].createMRAPI,method:"post",data:t})}function c(t){var e=Object(s["b"])(o["a"].project_key,!0);return t.token=e,Object(n["a"])({url:i["a"].getRoomByIDApi,method:"post",data:t})}function d(t){var e=Object(s["b"])(o["a"].project_key,!0);return t.token=e,Object(n["a"])({url:i["a"].createMCApi,method:"post",data:t})}function p(t){var e=Object(s["b"])(o["a"].project_key,!0);return t.token=e,Object(n["a"])({url:i["a"].updateMCApi,method:"post",data:t})}function g(t){return h(t,i["a"].approveMRApi)}function f(t){return h(t,i["a"].editMRAPI)}function h(t,e){var a=Object(s["b"])(o["a"].project_key,!0);return t.token=a,Object(n["a"])({url:e,method:"post",data:t})}function m(t){return h(t,i["a"].rejectMRApi)}}}]);
//# sourceMappingURL=chunk-6b22a7ef.4daa7ff5.js.map